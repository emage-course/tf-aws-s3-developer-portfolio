### Installing plugins in Jenkins

Now we need to install some plugins in our Jenkins service so that the pipeline script we are about to write in the Jenkins job will be set up properly.

**Step 1:** Go to Jenkins dashboard, and then to Plugin Manager. 

**Step 2:** Here, click on the Available tab and search for the following plugins

- Docker
- Docker Pipeline
- Amazon ECR plugin
- blue
- aws
- ecr 
- s3 


### Creating ECR Repository
### Creating IAM Role

aws ec2 describe-instances --query "Reservations[*].Instances[*].[VpcId, InstanceId, ImageId, InstanceType]"
aws rds describe-db-instances --query "DBInstances[*].[DBInstanceIdentifier, DBName, DBInstanceStatus, AvailabilityZone, DBInstanceClass]"
aws iam list-roles --query "Roles[?RoleName == 'example-role'].[RoleName, Arn]"
aws sts get-caller-identity

### Create an IAM Admin user using AWS CLI

1. Create an IAM user by running the following command
aws iam create-user --user-name <IAM_username>

2. (Optional) If you have not created an Admin group already, you can create one in this step, else skip to step 5. Run the following command to create a user group
aws iam create-group --group-name <Group_name>

3. Attach the AdministratorAccess policy to the group created
aws iam attach-group-policy --policy-arn arn:aws:iam::aws:policy/AdministratorAccess --group-name <Group_name>

4. To check if the policy has been attached to the group, you can check by running the following command
aws iam list-attached-group-policies --group-name <Group_name>

5. Add the Admin user to the Admin group by running the following command
aws iam add-user-to-group --user-name <User_name> --group-name <Group_name>

6. To check if the user got added to the group, run the following command
aws iam list-groups-for-user --user-name <User_name>

aws iam create-role --role-name admin-role --assume-role-policy-document file://~/scripts/admin-role-trust-policy.json
aws iam attach-role-policy --role-name admin-role --policy-arn "arn:aws:iam::aws:policy/AdministratorAccess"
aws iam list-attached-role-policies --role-name admin-role

admin-role-trust-policy.json

{
  "Version": "2012-10-17",
  "Statement": {
    "Effect": "Allow",
    "Principal": {
      "AWS": "00000000"
    },
    "Action": "sts:AssumeRole"
  }
}


